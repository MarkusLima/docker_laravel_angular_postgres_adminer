<div class="container mt-4">
  <h2>Buscar GitHub User</h2>
  <div class="input-group mb-3">
    <input [(ngModel)]="userName" class="form-control" placeholder="Nome de usuário" />
    <button class="btn btn-primary" (click)="fetchUser()">Buscar</button>
  </div>
  <div *ngIf="errorUser" class="alert alert-danger">{{ errorUser }}</div>
  
  <div *ngIf="user as u" class="card p-4 shadow-sm mt-4">
    <div class="row">
      <div class="col-md-3 text-center">
        <img [src]="u.avatar_url" alt="Avatar" class="img-fluid rounded-circle mb-3" />
        <a class="btn btn-outline-primary" [href]="u.html_url" target="_blank">
          Ver no GitHub
        </a>
      </div>
      <div class="col-md-9">
        <h3>{{ u.name }} <small class="text-muted">({{ u.login }})</small></h3>
        <p *ngIf="u.bio">{{ u.bio }}</p>
        <p><strong>Empresa:</strong> {{ u.company }}</p>
        <p><strong>Localização:</strong> {{ u.location }}</p>
        <p>
          <strong>Blog:</strong>
          <a *ngIf="u.blog" [href]="u.blog" target="_blank">{{ u.blog }}</a>
        </p>
        <p>
          <strong>Repositórios:</strong> {{ u.public_repos }} |
          <strong>Gists:</strong> {{ u.public_gists }}
        </p>
        <p>
          <strong>Seguidores:</strong> {{ u.followers }} |
          <strong>Seguindo:</strong> {{ u.following }}
        </p>
        <p>
          <strong>Conta criada:</strong> {{ u.created_at }}
        </p>
      </div>
    </div>
  </div>

  <hr>

  <h2>Following</h2>
  <button class="btn btn-secondary mb-2" (click)="fetchFollowing()">Buscar Following</button>
  <div *ngIf="errorFollowing" class="alert alert-danger">{{ errorFollowing }}</div>
  <div *ngIf="following">
    <div class="list-group mb-3">
      <a *ngFor="let f of following.itens"
        [href]="f.html_url"
        target="_blank"
        class="list-group-item list-group-item-action d-flex align-items-center">
        <img [src]="f.avatar_url" alt="Avatar" width="40" height="40" class="rounded-circle me-3" />
        {{ f.login }}
      </a>
    </div>
    <nav class="mt-3">
      <ul class="pagination">
        <li class="page-item" [class.disabled]="!following.has_previous_page">
          <button class="page-link" (click)="changeFollowingPage(-1)">Anterior</button>
        </li>
        <li class="page-item">
          <span class="page-link">{{ following.page }} / {{ following.total_pages }}</span>
        </li>
        <li class="page-item" [class.disabled]="!following.has_next_page">
          <button class="page-link" (click)="changeFollowingPage(1)">Próxima</button>
        </li>
      </ul>
    </nav>
  </div>

  <hr>

  <h2>Logs</h2>
  <div class="input-group mb-3">
    <input class="form-control" [(ngModel)]="searchTerm" placeholder="Buscar logs por termo" />
    <button class="btn btn-secondary" (click)="fetchLogs()">Buscar Logs</button>
  </div>
  <div *ngIf="errorLogs" class="alert alert-danger">{{ errorLogs }}</div>
  <div *ngIf="logs">
  <table class="table table-bordered">
    <thead class="table-light">
      <tr>
        <th>ID</th>
        <th>Método</th>
        <th>Path</th>
        <th>Status</th>
        <th>IP</th>
        <th>Data</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let log of logs.itens">
        <td>{{ log.id }}</td>
        <td>{{ log.method }}</td>
        <td>{{ log.path }}</td>
        <td>{{ log.status }}</td>
        <td>{{ log.ip }}</td>
        <td>{{ log.created_at }}</td>
      </tr>
    </tbody>
  </table>

  <nav class="mt-3">
    <ul class="pagination">
      <li class="page-item" [class.disabled]="!logs.has_previous_page">
        <button class="page-link" (click)="changeLogsPage(-1)">Anterior</button>
      </li>
      <li class="page-item">
        <span class="page-link">{{ logs.page }} / {{ logs.total_pages }}</span>
      </li>
      <li class="page-item" [class.disabled]="!logs.has_next_page">
        <button class="page-link" (click)="changeLogsPage(1)">Próxima</button>
      </li>
    </ul>
  </nav>
</div>

</div>